<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="zend-soap">  
    <link rel="shortcut icon" href="../img/favicon.ico">

    <title>Servers - zend-soap - Zend Framework Docs</title>

    <link rel="stylesheet" href="../css/styles-f3b53f5ceb.css">
</head>
<body id="page-top">

    
    <div class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">

            
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            
            <span class="navbar-brand">
                <a class="logo-link" href="https://framework.zend.com/" data-tooltip data-placement="bottom" title="Go to the ZF homepage">
                    <img src="../img/zend-framework-logo.svg" height="28" alt="Zend Framework">
                </a>
            </span>
        </div>

        <div class="navbar-collapse collapse">

            
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="https://framework.zend.com/about">About</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/downloads">Install</a>
                </li>
                <li class="active">
                    <a href="https://docs.zendframework.com">Documentation</a>
                </li>
                <li>
                    <a href="https://www.zend.com/en/services/training">Training</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/blog">Blog</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/participate">Participate</a>
                </li>
            </ul>

            
            
                <div class="nav navbar-nav navbar-collapse visible-xs-block ">
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="..">zend-soap</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            
                
                    <li class="subnavigation__list-item ">
                        <a href=".." class="subnavigation__link">zend-soap</a>
                    </li>
                
            
                
                    <li class="subnavigation__list-item">
                        <span class="subnavigation__headline">Reference</span>
                        <ul class="subnavigation__list">
                            
                                
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Servers</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../client/" class="subnavigation__link">Clients</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../wsdl/" class="subnavigation__link">WSDL Parsing and Generation</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../auto-discovery/" class="subnavigation__link">WSDL AutoDiscovery</a>
    </li>

                            
                        </ul>
                    </li>
                
            
        </ul>
    </div>

                </div>
            

            
            <div class="nav navbar-nav navbar-collapse visible-xs-block">
                <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
            </div>
        </div>
    </div>
</div>

    
    <header class="header">
    <div class="container">
        <div class="row">

            
            <div class="col-xs-8">
                <h1 class="header__title">
                    Documentation

                    
                        <small class="header__subtitle">zend-soap</small>
                    
                </h1>
            </div>

            
            <div class="col-xs-4 text-right">
                
                    <a href="#" class="header__link header__link--search" data-toggle="modal" data-target="#mkdocs_search_modal" title="Open search">
                        <i class="fa fa-search"></i> Search
                    </a>
                    <a href="https://github.com/zendframework/zend-soap/" class="header__link header__link--github" title="Go to repository of zend-soap">
                        <i class="fa fa-github"></i> GitHub
                    </a>
                
            </div>
        </div>
    </div>
</header>

    
    <div class="laminas-announcement">
    <div class="container">
        <div class="row">
            <div class="col-xs-12">
                Zend Framework transitions to the Linux Foundation. <a href="https://getlaminas.org">Learn More.</a>
            </div>
        </div>
    </div>
</div>

    
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-xs-12 content" role="main">
            <!-- content:begin -->
                
                    <ol class="breadcrumb" role="navigation" aria-label="breadcrumbs navigation">
    <li><a href="https://framework.zend.com/">Home</a></li>

    
        <li><a href="https://docs.zendframework.com/">Documentation</a></li>

        
            <li><a href="..">zend-soap</a></li>

            
                
                    <li>Reference</li>
                
            

            <li class="active">Servers</li>
        
    
</ol>


    
        <h2 class="chapter__headline">Reference</h2>
    

    
    

    
    
        <div class="toc">
            <h6 class="toc__headline">In This Article</h6>
            <ul class="toc__list">
                
                    <li class="toc__entry">
                        <a href="#zendsoapserver-instantiation" class="toc__link">Zend\Soap\Server instantiation</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#defining-your-soap-api" class="toc__link">Defining your SOAP API</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#request-and-response-handling" class="toc__link">Request and response handling</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#documentliteral-wsdl-handling" class="toc__link">Document/Literal WSDL Handling</a>
                    </li>
                
            </ul>
        </div>
    


    <h1 id="zend92soap92server">Zend\Soap\Server</h1>
<p><code>Zend\Soap\Server</code> provides a wrapper around PHP's
<a href="http://php.net/SoapServer">SoapServer</a> implementation with convenience
functionality for generating WSDL and registering internal handlers.</p>
<p>It may be used in WSDL or non-WSDL mode, and can map functionality to either PHP
classes or functions in order to define your web service API.</p>
<p>When in WSDL mode, it uses a prepared WSDL document to define server object
behavior and transport layer options.</p>
<p>WSDL documents may be auto-generated with functionality provided by the
<a href="../auto-discovery/">Zend\Soap\AutoDiscover</a> component, or constructed manually
using the <a href="../wsdl/">Zend\Soap\Wsdl</a> class or any other XML generation tool.</p>
<p>If the non-WSDL mode is used, then all protocol options must be provided via the
options mechanism.</p>
<h2 id="zendsoapserver-instantiation">Zend\Soap\Server instantiation</h2>
<p>Instantiation of <code>Server</code> instances varies based on whether or not you are using
WSDL mode.</p>
<h3 id="options-available-in-either-mode">Options available in either mode</h3>
<ul>
<li><code>parse_huge</code> (since 2.7.0): when set to a boolean true, ensures the
  <code>LIBXML_PARSEHUGE</code> flag is passed to <code>DOMDocument::loadXML()</code> when handling an
  incoming request. This can resolve issues with receiving large payloads.</li>
</ul>
<h3 id="instantiation-for-wsdl-mode">Instantiation for WSDL mode</h3>
<p>When in WSDL mode, the constructor expects two optional parameters:</p>
<ul>
<li><code>$wsdl</code>: the URI of a WSDL file. This may be set after-the-fact using
  <code>$server-&gt;setWsdl($wsdl)</code>.</li>
<li><code>$options</code>: options to use when creating the instance. These may be set later
  using <code>$server-&gt;setOptions($options)</code>.</li>
</ul>
<p>The following options are recognized in the WSDL mode:</p>
<ul>
<li><code>soap_version</code> (<code>soapVersion</code>) - soap version to use (<code>SOAP_1_1</code> or <code>SOAP_1_2</code>).</li>
<li><code>actor</code> - the actor URI for the server.</li>
<li><code>classmap</code> (<code>classMap</code>) which can be used to map some WSDL types to PHP
  classes. The option must be an array with WSDL types as keys, and names of PHP
  classes as values.</li>
<li><code>encoding</code> - internal character encoding (UTF-8 is always used as an external encoding).</li>
<li><code>wsdl</code> - equivalent to calling <code>setWsdl($wsdlValue)</code>.</li>
</ul>
<h3 id="instantiation-for-non-wsdl-mode">Instantiation for non-WSDL mode</h3>
<p>The first constructor parameter <strong>must</strong> be set to <code>NULL</code> if you plan to use
<code>Zend\Soap\Server</code> functionality in non-WSDL mode.</p>
<p>You also have to set the <code>uri</code> option in this case (see below).</p>
<p>The second constructor parameter, <code>$options</code>, is an array of options for
configuring the behavior of the server; these may also be provided later using
<code>$server-&gt;setOptions($options)</code>. Options recognized in non-WSDL mode include:</p>
<ul>
<li><code>soap_version</code> (<code>soapVersion</code>) - soap version to use (<code>SOAP_1_1</code> or <code>SOAP_1_2</code>).</li>
<li><code>actor</code> - the actor URI for the server.</li>
<li><code>classmap</code> (<code>classMap</code>) - an associative array used to map WSDL types to PHP
  classes. The option must be an associative array using WSDL types as the
  keys, and PHP class names as values.</li>
<li><code>encoding</code> - internal character encoding (UTF-8 is always used as an external
  encoding).</li>
<li><code>uri</code> (required) - URI namespace for SOAP server.</li>
</ul>
<h2 id="defining-your-soap-api">Defining your SOAP API</h2>
<p>There are two ways to define your SOAP API in order to expose PHP functionality.</p>
<p>The first one is to attach a class to the <code>Zend\Soap\Server</code> object that
completely describes your API:</p>
<pre class="codehilite"><code class="language-php">class MyClass
{
    /**
     * This method takes ...
     *
     * @param integer $inputParam
     * @return string
     */
    public function method1($inputParam)
    {
        // ...
    }

    /**
     * This method takes ...
     *
     * @param integer $inputParam1
     * @param string  $inputParam2
     * @return float
     */
    public function method2($inputParam1, $inputParam2)
    {
        // ...
    }

    /* ... */
}

$server = new Zend\Soap\Server(null, $options);

// Bind class to Soap Server:
$server-&gt;setClass(MyClass::class);

// Or bind an instance:
$server-&gt;setObject(new MyClass());

// Handle a request:
$server-&gt;handle();</code></pre>

<blockquote>
<h3 id="docblocks-are-required">Docblocks are required</h3>
<p>You should completely describe each method using a method docblock if you plan
to use autodiscover functionality to prepare your WSDL.</p>
</blockquote>
<p>The second method for defining your API is to use one or more functions, passing
them to one or more of the <code>addFunction()</code> or <code>loadFunctions()</code> methods:</p>
<pre class="codehilite"><code class="language-php">/**
 * This function ...
 *
 * @param integer $inputParam
 * @return string
 */
function function1($inputParam)
{
    // ...
}

/**
 * This function ...
 *
 * @param integer $inputParam1
 * @param string  $inputParam2
 * @return float
 */
function function2($inputParam1, $inputParam2)
{
    // ...
}

$server = new Zend\Soap\Server(null, $options);
$server-&gt;addFunction('function1');
$server-&gt;addFunction('function2');

$server-&gt;handle();</code></pre>

<h2 id="request-and-response-handling">Request and response handling</h2>
<p><code>Zend\Soap\Server</code> component performs request/response processing automatically,
but allows you to intercept each in order to perform pre- or post-processing.</p>
<h3 id="request-pre-and-post-processing">Request pre- and post-processing</h3>
<p>The <code>Zend\Soap\Server::handle()</code> method handles a request from the standard
input stream ('php://input'). It may be overridden either by supplying a request
instance to the <code>handle()</code> method, or by setting the request via the
<code>setRequest()</code> method:</p>
<pre class="codehilite"><code class="language-php">$server = new Zend\Soap\Server(/* ... */);

// Set request using optional $request parameter to the handle() method:
$server-&gt;handle($request);

// Set request using setRequest() method:
$server-&gt;setRequest();
$server-&gt;handle();</code></pre>

<p>A request object may be represented using any of the following, and handled as
follows:</p>
<ul>
<li><code>DOMDocument</code> (casts to XML)</li>
<li><code>DOMNode</code> (owner document is retrieved and cast to XML)</li>
<li><code>SimpleXMLElement</code> (casts to XML)</li>
<li><code>stdClass</code> (<code>__toString()</code> is called and verified to be valid XML)</li>
<li><code>string</code> (verified to be valid XML)</li>
</ul>
<p>The last request processed may be retrieved using the <code>getLastRequest()</code> method,
which returns the XML string:</p>
<pre class="codehilite"><code class="language-php">$server = new Zend\Soap\Server(/* ... */);

$server-&gt;handle();
$request = $server-&gt;getLastRequest();</code></pre>

<h3 id="response-post-processing">Response post-processing</h3>
<p>The <code>Zend\Soap\Server::handle()</code> method automatically emits the generated
response to the output stream. It may be blocked using <code>setReturnResponse()</code>
with <code>true</code> or <code>false</code> as a parameter. When set to <code>true</code>, <code>handle()</code> will
return the generated response instead of emitting it.</p>
<p>The returned response will be either an XML string representing the response, or
a <code>SoapFault</code> exception instance.</p>
<blockquote>
<h4 id="do-not-return-soapfaults">Do not return SoapFaults</h4>
<p>SoapFault instances, when cast to a string, will contain the full exception
stack trace. For security purposes, you do not want to return that
information. As such, check your return type before emitting the response
manually.</p>
</blockquote>
<pre class="codehilite"><code class="language-php">$server = new Zend\Soap\Server(/* ... */);

// Get a response as a return value of handle(),
// instead of emitting it to standard output:
$server-&gt;setReturnResponse(true);

$response = $server-&gt;handle();

if ($response instanceof SoapFault) {
    /* ... */
} else {
    /* ... */
}</code></pre>

<p>The last response emitted may also be retrieved for post-processing using
<code>getLastResponse()</code>:</p>
<pre class="codehilite"><code class="language-php">$server = new Zend\Soap\Server(/* ... */);

$server-&gt;handle();

$response = $server-&gt;getLastResponse();

if ($response instanceof SoapFault) {
    /* ... */
} else {
    /* ... */
}</code></pre>

<h2 id="documentliteral-wsdl-handling">Document/Literal WSDL Handling</h2>
<p>The document/literal binding-style/encoding pattern is used to make SOAP
messages as human-readable as possible and allow abstraction between very
incompatible languages. The .NET framework uses this pattern for SOAP service
generation by default. The central concept of this approach to SOAP is the
introduction of a Request and an Response object for every function/method of
the SOAP service. The parameters of the function are properties on the request
object, and the response object contains a single parameter that is built in the
style <code>&lt;methodName&gt;Result</code></p>
<p>zend-soap supports this pattern in both the AutoDiscover and Server
components. You can write your service object without knowledge of the pattern.
Use docblock comments to hint the parameter and return types as usual. The
<code>Zend\Soap\Server\DocumentLiteralWrapper</code> wraps around your service object and
converts request and response into normal method calls on your service.</p>
<p>See the class doc block of the <code>DocumentLiteralWrapper</code> for a detailed example
and discussion.</p>



    <nav>
    <ul class="page-nav hidden-print">

        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="..">
                    <i class="fa fa-chevron-left"></i> Previous
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../client/">
                    Next <i class="fa fa-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>



    <div class="help-wanted">
        <p>
            Found a mistake or want to contribute to the documentation?
            <a href="https://github.com/zendframework/zend-soap/edit/master/doc/book/server.md" target="_blank" class="help-wanted__link">
                Edit this page on GitHub!
            </a>
        </p>
    </div>

                
            <!-- content:end -->
            </div>
            <div class="col-md-3 col-xs-12 sidebar">
                
                    <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="..">zend-soap</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            
                
                    <li class="subnavigation__list-item ">
                        <a href=".." class="subnavigation__link">zend-soap</a>
                    </li>
                
            
                
                    <li class="subnavigation__list-item">
                        <span class="subnavigation__headline">Reference</span>
                        <ul class="subnavigation__list">
                            
                                
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Servers</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../client/" class="subnavigation__link">Clients</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../wsdl/" class="subnavigation__link">WSDL Parsing and Generation</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../auto-discovery/" class="subnavigation__link">WSDL AutoDiscovery</a>
    </li>

                            
                        </ul>
                    </li>
                
            
        </ul>
    </div>

                
            </div>
        </div>
    </div>

    
    <footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-9">
                <h5>Zend Framework</h5>
                <ul>
                    <li><a href="https://framework.zend.com/">framework.zend.com</a></li>
                    <li><a href="https://docs.zendframework.com">docs.zendframework.com</a></li>
                    <li><a href="https://packages.zendframework.com">packages.zendframework.com</a></li>
                    <li><a href="https://apigility.org">apigility.org</a></li>
                    <li><a href="https://getexpressive.org/">getexpressive.org</a></li>
                </ul>
            </div>
        </div>

        
        <div class="row">
            <div class="col-md-12 text-center">
                <a class="footer__button" href="#page-top"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="row">

            
            <div class="col-md-9">
                <h4 class="footer__headline">Copyright</h4>
                <p>&copy; 2006-2019 by <a href="https://www.zend.com/">Zend</a>, a <a href="https://www.roguewave.com/">Rogue Wave Company</a>.</p>
            </div>

            
            <div class="col-md-3">
                <h4 class="footer__headline">Support</h4>
                <ul class="support__list">
                    <li class="support__list-item">
                        <a href="https://discourse.zendframework.com" class="support__link" title="Forum"><i class="fa fa-comments"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://zendframework-slack.herokuapp.com" class="support__link" title="Chat"><i class="fa fa-slack"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://github.com/zendframework" class="support__link" title="Github"><i class="fa fa-github"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://twitter.com/zfdevteam" class="support__link" title="Twitter"><i class="fa fa-twitter"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://tinyletter.com/mwopzend" class="support__link" title="Newsletter"><i class="fa fa-envelope"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://framework.zend.com/blog/feed-rss.xml" class="support__link" title="Blog feed"><i class="fa fa-rss"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://framework.zend.com/security/feed" class="support__link" title="Security feed"><i class="fa fa-rss-square"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>

    <script>
        var base_url = '..',
            siteName = 'zend-soap';
    </script>
    <script src="../js/scripts-8d7ae56abf.js"></script>
        <script src="../search/main.js"></script>

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>



</body>


</html>
